library(tidyverse); theme_set(theme_bw(base_size = 12))
library(lubridate)
eng_cases <- read_csv("C:/Users/eidedgri/Filr/My Files/COVID play/Data/nation_2021-11-27.csv") %>%
mutate(date = dmy(date))
eng_cases
eng_ages <- filter(eng_cases, age %in% c("00_59",
"60+"
))
eng_ages
new_ages <- filter(eng_ages, date > ymd("2021-10-01"))
ggplot(data = new_ages, aes(x = date, y = cases, group = age, colour = age)) +
geom_line()
ggplot(data = new_ages, aes(x = date, y = rollingRate, colour = age)) +
geom_line() +
ggtitle("Case rates")
eng_ages <- filter(eng_cases, age %in% c("00_04",
"05_09",
"10_14",
"15_19",
"20_24",
"25_29",
"30_34",
"35_39",
"40_44",
"45_49",
"50_54",
"55_59",
"60_64",
"65_69",
"70_74",
"75_79",
"80_84",
"85_89",
"90+"
))
eng_ages
eng_grps <- mutate(eng_ages, age_grp=case_when(
age %in% c("00_04", "05_09", "10_14", "15_19") ~ "0-19",
age %in% c("20_24", "25_29", "30_34", "35_39") ~ "20-39",
age %in% c("40_44", "45_49", "50_54", "55_59") ~ "40-59",
age %in% c("60_64", "65_69", "70_74", "75_79") ~ "60-79",
age %in% c("80_84", "85_89", "90+") ~ "80+"
))
eng_grps[1:20,]
sum_grps <- eng_grps %>%
group_by(date, age_grp) %>%
summarise(tot_case = sum(cases)) %>%
arrange(desc(date), age_grp)
sum_grps
new_grps <- filter(sum_grps, date > ymd("2021-10-01"))
ggplot(data = new_grps, aes(x = date, y = tot_case, group = age_grp, colour = age_grp)) +
geom_line() +
ggtitle("Cases by age group")
eng_deaths <- read_csv("C:/Users/eidedgri/Filr/My Files/COVID play/Data/deaths_2021-11-28.csv") %>%
mutate(date = dmy(date))
eng_deaths
eng_fdeaths <- filter(eng_deaths, age %in% c("00_59",
"60+"
))
eng_fdeaths
new_fdeaths <- filter(eng_fdeaths, date > ymd("2021-10-01")) %>%
mutate(rollingRate = rollingRate*100)
new_fdeaths
ggplot(data = new_fdeaths, aes(x = date, y = deaths, group = age, colour = age)) + geom_line()
ggplot(data = new_fdeaths, aes(x = date, y = rollingRate, group = age, colour = age)) +
geom_line() +
ggtitle("Death rates")
eng_dages <- filter(eng_deaths, age %in% c("00_04",
"05_09",
"10_14",
"15_19",
"20_24",
"25_29",
"30_34",
"35_39",
"40_44",
"45_49",
"50_54",
"55_59",
"60_64",
"65_69",
"70_74",
"75_79",
"80_84",
"85_89",
"90+"
))
eng_dages
eng_dgrps <- mutate(eng_dages, age_grp=case_when(
age %in% c("00_04", "05_09", "10_14", "15_19") ~ "0-19",
age %in% c("20_24", "25_29", "30_34", "35_39") ~ "20-39",
age %in% c("40_44", "45_49", "50_54", "55_59") ~ "40-59",
age %in% c("60_64", "65_69", "70_74", "75_79") ~ "60-79",
age %in% c("80_84", "85_89", "90+") ~ "80+"
))
eng_dgrps
sum_dgrps <- eng_dgrps %>%
group_by(date, age_grp) %>%
summarise(tot_dth = sum(deaths)) %>%
arrange(desc(date), age_grp)
sum_dgrps
new_dgrps <- filter(sum_dgrps, date > ymd("2021-10-01"))
ggplot(data = new_dgrps, aes(x = date, y = tot_dth, group = age_grp, colour = factor(age_grp))) + geom_line()
ggplot(data = new_fdeaths, aes(x = date, y = rollingRate, group = age, colour = age)) +
geom_line(linetype = "dashed") +
geom_line(data = new_ages) +
facet_grid(age ~ .) +
theme(legend.position = "none") +
ggtitle("Case and Death rates per 100,000 population",
subtitle = "Solid = cases; Dash = deaths")
